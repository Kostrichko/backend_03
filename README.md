# Task Manager â€” Django + Aiogram

Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ°Ğ¼Ğ¸: Django REST API Ğ±ÑĞºĞµĞ½Ğ´ + Telegram-Ğ±Ğ¾Ñ‚ Ğ½Ğ° aiogram Ñ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸ÑĞ¼Ğ¸ Ñ‡ĞµÑ€ĞµĞ· Celery.

## Ğ¡Ñ‚ĞµĞº

| ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ | Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ |
|-----------|-----------|
| Backend | Django 5.2, DRF |
| Bot | aiogram 3.4 |
| Ğ‘Ğ” | PostgreSQL 16 |
| ĞÑ‡ĞµÑ€ĞµĞ´ÑŒ Ğ·Ğ°Ğ´Ğ°Ñ‡ | Celery 5.4 + Redis |
| ĞšĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ | Docker Compose |
| CI | GitHub Actions |

## Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚

```bash
git clone <repository-url>
cd django_aiogram
```

Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ `.env` Ğ² ĞºĞ¾Ñ€Ğ½Ğµ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°:

```env
BOT_TOKEN=Ñ‚Ğ¾ĞºĞµĞ½_Ğ¾Ñ‚_@BotFather
API_KEY=Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ»ÑŒĞ½Ñ‹Ğ¹_ÑĞµĞºÑ€ĞµÑ‚Ğ½Ñ‹Ğ¹_ĞºĞ»ÑÑ‡
POSTGRES_DB=django_aiogram
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
```

Ğ—Ğ°Ğ¿ÑƒÑĞº:

```bash
docker compose up -d --build
docker compose exec web python manage.py migrate
```

ĞÑ‚ĞºÑ€Ğ¾Ğ¹Ñ‚Ğµ Ğ±Ğ¾Ñ‚Ğ° Ğ² Telegram Ğ¸ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ÑŒÑ‚Ğµ `/start`.

## ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     HTTP/JSON      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Telegram    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   aiogram    â”‚
â”‚  Bot API     â”‚                    â”‚   (bot/)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚ aiohttp
                                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PostgreSQL  â”‚â—„â”€â”€â”€â”€â”‚    Django    â”‚â—„â”€â”€â”€â”€â”‚    Redis     â”‚
â”‚              â”‚     â”‚  (backend/) â”‚     â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚                     â”‚
                            â–¼                     â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
                     â”‚   Celery     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚   Worker     â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**5 Docker-ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¾Ğ²:** postgres, redis, web, bot, celery-worker.

### Ğ’Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ

- Ğ‘Ğ¾Ñ‚ Ğ¾Ğ±Ñ‰Ğ°ĞµÑ‚ÑÑ Ñ Ğ±ÑĞºĞµĞ½Ğ´Ğ¾Ğ¼ Ğ¿Ğ¾ Ğ²Ğ½ÑƒÑ‚Ñ€ĞµĞ½Ğ½ĞµĞ¹ ÑĞµÑ‚Ğ¸ Docker Ñ‡ĞµÑ€ĞµĞ· HTTP JSON API
- ĞÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ â€” Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ¾Ğº `X-API-Key`
- Ğ‘ÑĞºĞµĞ½Ğ´ â€” ĞµĞ´Ğ¸Ğ½ÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğ¹, ĞºÑ‚Ğ¾ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ñ Ğ‘Ğ”
- Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ Ğ¿Ğ»Ğ°Ğ½Ğ¸Ñ€ÑƒÑÑ‚ÑÑ Ñ‡ĞµÑ€ĞµĞ· Celery ETA (Ğ±ĞµĞ· polling)

## Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

```
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ config/                  # ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Django, Celery, URL-Ñ€Ğ¾ÑƒÑ‚Ğ¸Ğ½Ğ³
â”‚   â”‚   â”œâ”€â”€ settings.py
â”‚   â”‚   â”œâ”€â”€ settings_test.py     # Ğ¢ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğµ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ (SQLite in-memory)
â”‚   â”‚   â”œâ”€â”€ celery.py
â”‚   â”‚   â””â”€â”€ urls.py
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ models.py            # User, Task, Tag
â”‚   â”‚   â”œâ”€â”€ views.py             # API-ÑĞ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚Ñ‹
â”‚   â”‚   â”œâ”€â”€ serializers.py       # DRF-ÑĞµÑ€Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ‚Ğ¾Ñ€Ñ‹
â”‚   â”‚   â”œâ”€â”€ middleware.py        # APIKeyMiddleware
â”‚   â”‚   â”œâ”€â”€ tasks.py             # Celery-Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ° ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğ¹
â”‚   â”‚   â”œâ”€â”€ services/            # Service Layer
â”‚   â”‚   â”‚   â”œâ”€â”€ user_service.py
â”‚   â”‚   â”‚   â”œâ”€â”€ task_service.py
â”‚   â”‚   â”‚   â””â”€â”€ tag_service.py
â”‚   â”‚   â””â”€â”€ tests/               # 54 Ñ‚ĞµÑÑ‚Ğ°
â”‚   â”‚       â”œâ”€â”€ test_models.py
â”‚   â”‚       â”œâ”€â”€ test_serializers.py
â”‚   â”‚       â”œâ”€â”€ test_services.py
â”‚   â”‚       â””â”€â”€ test_views.py
â”‚   â”œâ”€â”€ pyproject.toml           # Black, isort, mypy, coverage
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”œâ”€â”€ requirements-dev.txt
â”‚   â””â”€â”€ run_checks.sh
â”œâ”€â”€ bot/
â”‚   â”œâ”€â”€ main.py                  # Ğ¢Ğ¾Ñ‡ĞºĞ° Ğ²Ñ…Ğ¾Ğ´Ğ°
â”‚   â”œâ”€â”€ config.py                # ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ±Ğ¾Ñ‚Ğ°
â”‚   â”œâ”€â”€ handlers/                # ĞœĞ¾Ğ´ÑƒĞ»ÑŒĞ½Ñ‹Ğµ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞ¸
â”‚   â”‚   â”œâ”€â”€ __init__.py          # register_handlers()
â”‚   â”‚   â”œâ”€â”€ common.py            # /start, ĞºĞ»Ğ°Ğ²Ğ¸Ğ°Ñ‚ÑƒÑ€Ğ°
â”‚   â”‚   â”œâ”€â”€ tasks.py             # CRUD Ğ·Ğ°Ğ´Ğ°Ñ‡, FSM
â”‚   â”‚   â””â”€â”€ tags.py              # CRUD Ñ‚ĞµĞ³Ğ¾Ğ², FSM
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ api_client.py        # HTTP-ĞºĞ»Ğ¸ĞµĞ½Ñ‚ Ğº Ğ±ÑĞºĞµĞ½Ğ´Ñƒ
â”‚   â”œâ”€â”€ tests/                   # 5 Ñ‚ĞµÑÑ‚Ğ¾Ğ²
â”‚   â”‚   â”œâ”€â”€ conftest.py
â”‚   â”‚   â”œâ”€â”€ test_api_client.py
â”‚   â”‚   â””â”€â”€ test_handlers.py
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”œâ”€â”€ requirements-dev.txt
â”‚   â”œâ”€â”€ pytest.ini
â”‚   â””â”€â”€ run_checks.sh
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ Dockerfile
â””â”€â”€ .env
```

## API

Ğ’ÑĞµ ÑĞ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚Ñ‹ Ñ‚Ñ€ĞµĞ±ÑƒÑÑ‚ Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²Ğ¾Ğº `X-API-Key`. ĞŸÑ€ĞµÑ„Ğ¸ĞºÑ: `/api/`.

### Ğ­Ğ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚Ñ‹

| ĞœĞµÑ‚Ğ¾Ğ´ | URL | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Ğ¢ĞµĞ»Ğ¾ / ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ | ĞÑ‚Ğ²ĞµÑ‚ |
|-------|-----|----------|------------------|-------|
| POST | `/register/` | Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ | `{telegram_id, username}` | `{telegram_id, username}` |
| GET | `/tasks/` | ĞĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸ | `?telegram_id=` | `{"tasks": [...]}` |
| POST | `/tasks/create/` | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ | `{telegram_id, title, due_date?, tags?}` | `{id, title, status, ...}` |
| POST | `/tasks/delete/` | Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ | `{telegram_id, task_id}` | `{"status": "ok"}` |
| GET | `/tags/` | Ğ¢ĞµĞ³Ğ¸ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ | `?telegram_id=` | `{"tags": [...]}` |
| POST | `/tags/create/` | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ñ‚ĞµĞ³ | `{telegram_id, name}` | `{id, name}` |
| POST | `/tags/delete/` | Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ñ‚ĞµĞ³ | `{telegram_id, tag_id}` | `{"status": "ok"}` |
| GET | `/archive/` | ĞÑ€Ñ…Ğ¸Ğ² Ğ·Ğ°Ğ´Ğ°Ñ‡ | `?telegram_id=` | `{"tasks": [...]}` |
| POST | `/clear/` | ĞÑ‡Ğ¸ÑÑ‚Ğ¸Ñ‚ÑŒ Ğ²ÑÑ‘ | `{telegram_id}` | `{"status": "ok"}` |

### Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº

```json
{"error": "Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸"}
```

ĞšĞ¾Ğ´Ñ‹: `400` â€” Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ, `401` â€” Ğ½ĞµĞ²Ğ°Ğ»Ğ¸Ğ´Ğ½Ñ‹Ğ¹ API-ĞºĞ»ÑÑ‡, `404` â€” Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾, `500` â€” ÑĞµÑ€Ğ²ĞµÑ€Ğ½Ğ°Ñ Ğ¾ÑˆĞ¸Ğ±ĞºĞ°.

## ĞœĞ¾Ğ´ĞµĞ»Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

```
User (PK: telegram_id)
 â”œâ”€â”€ Tag (name, unique per user)
 â””â”€â”€ Task (title, status, due_date?, created_at)
      â””â”€â”€ tags (M2M â†’ Tag)
```

**Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑÑ‹ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸:** `pending` â†’ `completed` | `deleted`

## Ğ›Ğ¸Ğ¼Ğ¸Ñ‚Ñ‹

| ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ | Ğ—Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ | ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° |
|----------|----------|-----------|
| ĞĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… Ğ·Ğ°Ğ´Ğ°Ñ‡ | 6 | `MAX_PENDING_TASKS_PER_USER` |
| Ğ¢ĞµĞ³Ğ¾Ğ² | 4 | `MAX_TAGS_PER_USER` |
| ĞÑ€Ñ…Ğ¸Ğ²Ğ½Ñ‹Ñ… Ğ·Ğ°Ğ´Ğ°Ñ‡ (Ğ² ÑĞ¿Ğ¸ÑĞºĞµ) | 5 | `MAX_ARCHIVE_TASKS_PER_USER` |

ĞĞ°ÑÑ‚Ñ€Ğ°Ğ¸Ğ²Ğ°ÑÑ‚ÑÑ Ğ² `backend/config/settings.py` Ğ¸ Ğ´ÑƒĞ±Ğ»Ğ¸Ñ€ÑƒÑÑ‚ÑÑ Ğ² `bot/config.py`.

## Telegram-Ğ±Ğ¾Ñ‚

### ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ğ¸ ĞºĞ½Ğ¾Ğ¿ĞºĞ¸

| ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ° / ĞšĞ½Ğ¾Ğ¿ĞºĞ° | Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ |
|------------------|----------|
| `/start` | Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ, Ğ³Ğ»Ğ°Ğ²Ğ½Ğ¾Ğµ Ğ¼ĞµĞ½Ñ |
| â• ĞĞ¾Ğ²Ğ°Ñ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ° | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸ (FSM: Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ â†’ Ğ²Ñ€ĞµĞ¼Ñ â†’ Ñ‚ĞµĞ³Ğ¸) |
| ğŸ“‹ ĞœĞ¾Ğ¸ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸ | Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ñ… Ğ·Ğ°Ğ´Ğ°Ñ‡ |
| ğŸ· Ğ¢ĞµĞ³Ğ¸ | Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ñ‚ĞµĞ³Ğ¾Ğ² Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸ĞµĞ¼ |
| ğŸ“¦ ĞÑ€Ñ…Ğ¸Ğ² | Ğ—Ğ°Ğ²ĞµÑ€ÑˆÑ‘Ğ½Ğ½Ñ‹Ğµ Ğ¸ ÑƒĞ´Ğ°Ğ»Ñ‘Ğ½Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸ |
| ğŸ—‘ Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ | Ğ’Ñ‹Ğ±Ğ¾Ñ€ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸ Ğ´Ğ»Ñ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ñ |
| â• ĞĞ¾Ğ²Ñ‹Ğ¹ Ñ‚ĞµĞ³ | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ñ‚ĞµĞ³Ğ° |

### FSM-ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ

**CreateTaskState:** `title` â†’ `notify_time` â†’ `tags`
- Ğ’Ñ€ĞµĞ¼Ñ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ: 1 Ğ¼Ğ¸Ğ½, 2 Ğ¼Ğ¸Ğ½, 5 Ğ¼Ğ¸Ğ½, 10 Ğ¼Ğ¸Ğ½, 1 Ñ‡Ğ°Ñ
- Ğ¢ĞµĞ³Ğ¸: Ğ²Ñ‹Ğ±Ğ¾Ñ€ Ğ¸Ğ· ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ñ… Ñ‡ĞµÑ€ĞµĞ· inline-ĞºĞ½Ğ¾Ğ¿ĞºĞ¸, Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ

**CreateTagState:** `name`

## Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ

ĞŸÑ€Ğ¸ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğ¸ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸ Ñ `due_date` Ğ±ÑĞºĞµĞ½Ğ´ ÑÑ‚Ğ°Ğ²Ğ¸Ñ‚ Celery-Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ Ñ `eta=due_date`. Ğ’ Ğ½Ğ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ½Ğ¾Ğµ Ğ²Ñ€ĞµĞ¼Ñ Ğ²Ğ¾Ñ€ĞºĞµÑ€ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ñ‡ĞµÑ€ĞµĞ· Telegram Bot API. ĞĞµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ polling â€” Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ° Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ÑÑ Ñ€Ğ¾Ğ²Ğ½Ğ¾ Ğ¾Ğ´Ğ¸Ğ½ Ñ€Ğ°Ğ· Ğ² Ğ½ÑƒĞ¶Ğ½Ñ‹Ğ¹ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚.

## Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

### Backend â€” 54 Ñ‚ĞµÑÑ‚Ğ°

```bash
# Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾ (Python 3.11+)
cd backend
pip install -r requirements.txt -r requirements-dev.txt
python manage.py test --settings=config.settings_test

# Ğ§ĞµÑ€ĞµĞ· Docker
docker compose exec web python manage.py test --settings=config.settings_test
```

Ğ¢ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğµ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸: SQLite in-memory, DummyCache, rate limiting Ğ¾Ñ‚ĞºĞ»ÑÑ‡Ñ‘Ğ½.

- **test_models.py** â€” ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¼Ğ¾Ğ´ĞµĞ»ĞµĞ¹, ÑĞ²ÑĞ·Ğ¸, ordering
- **test_serializers.py** â€” Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ²ÑĞµÑ… ÑĞµÑ€Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ‚Ğ¾Ñ€Ğ¾Ğ²
- **test_services.py** â€” Ğ±Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ° (Ğ»Ğ¸Ğ¼Ğ¸Ñ‚Ñ‹, Ğ´ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ‚Ñ‹, CRUD)
- **test_views.py** â€” Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ğµ Ñ‚ĞµÑÑ‚Ñ‹ ÑĞ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚Ğ¾Ğ² + APIKeyMiddleware

### Bot â€” 5 Ñ‚ĞµÑÑ‚Ğ¾Ğ²

```bash
cd bot
pip install -r requirements.txt -r requirements-dev.txt
pytest -W ignore::DeprecationWarning tests/
```

- **test_api_client.py** â€” ÑƒÑĞ¿ĞµÑˆĞ½Ñ‹Ğ¹ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ, Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° HTTP-Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
- **test_handlers.py** â€” `/start`, ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ·Ğ°Ğ´Ğ°Ñ‡ (Ğ¿ÑƒÑÑ‚Ğ¾Ğ¹ Ğ¸ Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸)

### Ğ›Ğ¸Ğ½Ñ‚Ğ¸Ğ½Ğ³

```bash
cd backend && ./run_checks.sh    # tests + black + isort + flake8 + mypy
cd bot && ./run_checks.sh        # tests + black + isort + flake8
```

## CI/CD

GitHub Actions (`.github/workflows/ci.yml`) â€” 3 Ğ¿Ğ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ñ‹Ñ… job'Ğ°:

| Job | Ğ§Ñ‚Ğ¾ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ |
|-----|---------------|
| `backend-test` | Django-Ñ‚ĞµÑÑ‚Ñ‹ (SQLite) |
| `bot-test` | pytest Ğ±Ğ¾Ñ‚Ğ° |
| `lint` | Black, isort, flake8, mypy (backend) |

Ğ¢Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ñ‹: push Ğ¸ PR Ğ² Ğ²ĞµÑ‚ĞºĞ¸ `main` Ğ¸ `dev`.

## ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ

| Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ | ĞĞ±Ğ¾ÑĞ½Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ |
|---------|-------------|
| `telegram_id` ĞºĞ°Ğº PK | Ğ£Ğ½Ğ¸ĞºĞ°Ğ»ĞµĞ½, Ğ½Ğµ Ğ¼ĞµĞ½ÑĞµÑ‚ÑÑ, Ğ¿Ñ€ÑĞ¼Ğ¾Ğ¹ Ğ¼Ğ°Ğ¿Ğ¿Ğ¸Ğ½Ğ³ Ğ±Ğ¾Ñ‚â†”API |
| Service Layer | Ğ‘Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ° Ğ¾Ñ‚Ğ´ĞµĞ»ĞµĞ½Ğ° Ğ¾Ñ‚ views, Ğ»ĞµĞ³ĞºĞ¾ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ |
| Celery ETA Ğ²Ğ¼ĞµÑÑ‚Ğ¾ beat | Ğ¢Ğ¾Ñ‡Ğ½Ñ‹Ğµ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ Ğ±ĞµĞ· Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ polling Ğ‘Ğ” |
| ĞĞ±Ñ‘Ñ€Ğ½ÑƒÑ‚Ñ‹Ğµ JSON-Ğ¾Ñ‚Ğ²ĞµÑ‚Ñ‹ | `{"tasks": [...]}` Ğ²Ğ¼ĞµÑÑ‚Ğ¾ Ğ³Ğ¾Ğ»Ñ‹Ñ… Ğ¼Ğ°ÑÑĞ¸Ğ²Ğ¾Ğ² â€” Ñ€Ğ°ÑÑˆĞ¸Ñ€ÑĞµĞ¼Ğ¾ÑÑ‚ÑŒ, ĞµĞ´Ğ¸Ğ½Ğ¾Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¸Ğµ |
| ReplyKeyboard | ĞŸĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ½Ğ¾ Ğ²Ğ¸Ğ´Ğ¸Ğ¼Ğ¾Ğµ Ğ¼ĞµĞ½Ñ, Ğ¼ĞµĞ½ÑŒÑˆĞµ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº Ğ²Ğ²Ğ¾Ğ´Ğ° |
| FSM Ğ´Ğ»Ñ Ğ´Ğ¸Ğ°Ğ»Ğ¾Ğ³Ğ¾Ğ² | Ğ§Ñ‘Ñ‚ĞºĞ°Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ°, Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ½Ğ° ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¼ ÑˆĞ°Ğ³Ğµ |
| APIKeyMiddleware | Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ²ÑĞµÑ… ÑĞ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚Ğ¾Ğ² Ğ¾Ğ´Ğ½Ğ¸Ğ¼ ÑĞ»Ğ¾ĞµĞ¼ |
| Rate limiting | django-ratelimit Ğ½Ğ° ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¼ ÑĞ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚Ğµ |
